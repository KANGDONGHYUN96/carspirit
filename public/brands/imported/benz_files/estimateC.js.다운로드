function calculate_finance(chng){if(chng!="fincC"&&$("#Finc_"+ebox+" .eSelfFincName").hasClass("sel"))fince.nameF=$("#Finc_"+ebox+" .ePutFincName").val();else fince.nameF=setFinc.name;fince.nameC=setFinc.codc;fince.codeF=setFinc.codf;fince.codeC=setFinc.codb;fince.kindC=setFinc.codk;fince.desc=setFinc.desc;fince.adBadge=setFinc.adbg;if(codes.finc=="self"||typeof fince.codeC=="undefined"){fince.codeC="self";fince.nameC="직접입력";fince.kindL="";if(codes.finc=="self"){fince.kindC=$("#fBox_"+ebox+"_type").val();setFinc.mona="6|12|18|24|30|36|48|60|72";setFinc.itra=codes.rate;if(fince.kindC.substr(0,1)=="G"){if(codes.monG)setFinc.monb=codes.monG;else setFinc.monb=12}}}if(chng=="compC"&&valCode.modl){price=new Array;price.base=number_only($("#modelPriceEvrg").val());price.itms=0;price.free=0}if(fince.kindC.substr(2,1)=="L")fince.kindL="대출상품";else if(fince.kindC.substr(2,1)=="C")fince.kindL="카드할부";var monArr=setFinc.mona.split("|");var monSel=0;var monMin=0;var monMax=0;if(chng=="compC"){var $obF=$("#fBox_"+ebox+"_monthSel");$obF.html("")}else if(chng!="fincC"){var $obF=$("#Finc_"+ebox+" .eSelFincMons");$obF.html("")}moS=6;for(mo=0;mo<monArr.length;mo++){var monArr2=monArr[mo].split("~");if(!monArr2[1])monArr2[1]=monArr2[0];monArr2[0]=parseInt(monArr2[0]);monArr2[1]=parseInt(monArr2[1]);for(mo2=monArr2[0];mo2<=monArr2[1];mo2++){if(mo2==codes.mon){monSel=codes.mon}else if(mo2<codes.mon){monMin=mo2}else if(!monMax){monMax=mo2}if(chng!="fincC"){if(mo2%moS==0||mo2==monSel||mo2==monArr2[0]&&mo2%6==0||mo2==monArr2[1])$obF.append('<option value="'+mo2+'"> '+mo2+" 개월</option>")}}}if(monSel){fince.mon=monSel}else if(monMin){fince.mon=monMin}else if(monMax){fince.mon=monMax}if(chng!="fincC"){$obF.val(fince.mon)}if(chng!="fincC"&&$("#Finc_"+ebox+" .eSelfFincMons").hasClass("sel")){fince.mon=codes.mon}monSelL=-1;for(mo=0;mo<monArr.length;mo++){var monArr2=monArr[mo].split("~");if(!monArr2[1])monArr2[1]=monArr2[0];if(monSelL<0&&fince.mon<=parseInt(monArr2[1]))monSelL=mo}if(monSelL>=0){fince.monL=monSelL}if(chng=="compC"){minCap=1e5;maxCap=1e9}else{var capArr=setFinc.pcpa.split("|");var capSel=0;var capArr2=new Array;if(!capArr[1]){capArr2=capArr[0].split("~")}else{capArr2=capArr[fince.monL].split("~")}if(parseInt(capArr2[0])<100){capArr2[0]=parseFloat(capArr2[0])}else{capArr2[0]=parseInt(capArr2[0])}if(parseInt(capArr2[1])<100){capArr2[1]=parseFloat(capArr2[1])}else{capArr2[1]=parseInt(capArr2[1])}if(valCode.brnd=="321"||valCode.brnd=="322")var basCap=price.base+price.itms+price.free+price.DCtax+price.trns;else var basCap=price.base+price.itms+price.free+price.DCtax+price.incnt;if(capArr2[0]<=100&&capArr2[1]<=100){if(capArr2[0]==0){maxCap=number_round(basCap,1e4,"ceil")-sumry.sign}else{maxCap=number_round(basCap-basCap*capArr2[0]/100,1e4,"floor")}minCap=number_round(basCap-basCap*capArr2[1]/100,1e4,"ceil")}else if(capArr2[0]>100&&capArr2[1]<=100){maxCap=number_round(basCap-capArr2[0],1e4,"floor");minCap=number_round(basCap-basCap*capArr2[1]/100,1e4,"ceil")}else if(capArr2[0]<=100&&capArr2[1]>100){minCap=number_round(basCap*capArr2[0]/100,1e4,"ceil");maxCap=number_round(capArr2[1],1e4,"floor");if(maxCap>basCap)maxCap=number_round(basCap,1e4,"floor")}else{minCap=capArr2[0];maxCap=capArr2[1];if(maxCap>basCap)maxCap=number_round(basCap,1e4,"floor")}}if(chng=="compC"){fince.cap=codes.cap;fince.cas=0}else if(chng=="fincC"){if(codes.cap<100)fince.cap=number_round(basCap-basCap*codes.cap/100,1e6,"floor");else fince.cap=codes.cap;if(minCap>fince.cap)fince.cap=minCap;else if(maxCap<fince.cap)fince.cap=maxCap;fince.cas=price.total-fince.cap}else{maxCas=number_round(price.total-minCap,1e4,"floor");minCas=number_round(price.total-maxCap,1e4,"ceil");if(codes.cap){fince.cap=codes.cap;if(minCap>fince.cap){fince.cap=minCap}else if(maxCap<fince.cap){fince.cap=maxCap}fince.cas=number_round(price.total-fince.cap,1e4,"ceil")}else{if(codes.cas<100)fince.cas=number_round(price.total*codes.cas/100,5e5,"floor");else fince.cas=codes.cas;if(minCas>fince.cas)fince.cas=minCas;else if(maxCas<fince.cas)fince.cas=maxCas;if(sumry.sign==fince.cas)fince.cap=number_round(price.total-fince.cas,1e4,"floor");else fince.cap=number_round(price.total-fince.cas,1e5,"floor")}var $obF=$("#Finc_"+ebox+" .eSelFincCash");$obF.html("");var stepV=5e5;var stepS=parseInt(minCas/5e5);var stepE=parseInt(maxCas/5e5);for(st=stepS;st<=stepE;st++){stepC=st*stepV;if(st==stepS)stepC=minCas;$obF.append('<option value="'+stepC+'"> '+number_format(stepC/1e4)+" 만원</option>");if(fince.cas>stepC&&fince.cas<stepC+stepV&&fince.cas!=stepV){$obF.append('<option value="'+fince.cas+'">'+number_format(fince.cas/1e4)+" 만원</option>")}}$obF.val(fince.cas)}if(chng=="compC")fince.casR=21;else fince.casR=number_round((basCap-fince.cap)/basCap*1e3,1,"floor")/10;var itrArr=setFinc.itra.split("|");if(chng!="fincC"&&$("#Finc_"+ebox+" .eSelfFincRate").hasClass("sel")){fince.itr=number_only($("#Finc_"+ebox+" .ePutFincRate").val())}else if(!itrArr[1]){fince.itr=itrArr[0]}else{fince.itr=itrArr[fince.monL]}if(fince.itr>100){fince.itr=finance_irrSel(fince.itr,fince.mon,fince.casR)}else if(setFinc.cfgb&&setFinc.cfgb.indexOf("C")>=0){var capArrB=setFinc.pcpb.split("/");var itrArrB=fince.itr.split("/");irCt=capArrB.length;fince.itr=-1;for(ir=0;ir<=irCt;ir++){if(fince.itr<0){if(ir==irCt){fince.itr=itrArrB[ir]}else{tmpArr=capArrB[ir].split("@");if(tmpArr[1]<100)compR=fince.casR;else compR=fince.cap;if(tmpArr[0]==">"&&compR>tmpArr[1])fince.itr=itrArrB[ir];else if(tmpArr[0]==">="&&compR>=tmpArr[1])fince.itr=itrArrB[ir];else if(tmpArr[0]=="<"&&compR<tmpArr[1])fince.itr=itrArrB[ir];else if(tmpArr[0]=="<="&&compR<=tmpArr[1])fince.itr=itrArrB[ir]}}}}fince.remS="";fince.rem=0;if(chng!="fincC"){$("#Finc_"+ebox+" .contList.FincS .Remn").css("display","none");$("#Finc_"+ebox+" .contList.FincS .Back").css("display","none")}if(fince.kindC.substr(0,1)=="U"&&chng=="compC"){if(codes.capU>0&&codes.capU<codes.cap)fince.rem=codes.capU;else fince.rem=codes.cap*.5}else if(fince.kindC.substr(0,1)=="U"){if(chng!="fincC")$("#Finc_"+ebox+" .contList.FincS .Remn").css("display","block");var remArr=setFinc.rema.split("|");var remSel=0;var remArr2=new Array;if(!remArr[1]){remArr2=remArr[0].split("~")}else{remArr2=remArr[fince.monL].split("~")}var $obF=$("#Finc_"+ebox+" .eSelFincRemn");if(codes.rem&&codes.rem<100){var remSel=parseFloat(codes.rem)}else if(codes.rem){$("#Finc_"+ebox+" .ePutFincRemn").val(codes.rem)}else if($obF.val()){var remSel=parseFloat($obF.val())}else{var remSel=""}if(chng!="fincC"&&$("#Finc_"+ebox+" .eSelfFincRemn").hasClass("sel")){fince.remS=number_only($("#Finc_"+ebox+" .ePutFincRemn").val());if(fince.remS<100){remSel=fince.remS;$("#Finc_"+ebox+" .contList.FincS .Remn .mody button").removeClass("sel");$("#Finc_"+ebox+" .contList.FincS .Remn .mody button").text("수정");$("#Finc_"+ebox+" .contList.FincS .Remn .auto").removeClass("dis");$("#Finc_"+ebox+" .contList.FincS .Remn .self").addClass("dis")}else{if(setFinc.remb.indexOf("P")>=0){remSel=number_round(fince.remS/basCap*100,1,"round")}else if(setFinc.remb.indexOf("C")>=0){remSel=number_round(fince.remS/fince.cap*100,1,"round")}}}$obF.html("");if(remArr2[1]){var stepR=5;var stepS=parseInt(remArr2[0]);var stepE=parseInt(remArr2[1]);if(remSel<remArr2[0]||remSel>remArr2[1])remSel=-1;for(st=stepS;st<=stepE;st+=stepR){$obF.append('<option value="'+st+'"> '+st+" %</option>");if(remSel>st&&remSel<st+stepR){$obF.append('<option value="'+remSel+'"> '+remSel+" %</option>")}}if(remSel<0)remSel=stepE;$obF.val(remSel)}else{if(remSel&&chng!="fincM"&&remSel!=remArr2[0])$obF.append('<option value="'+remSel+'">'+remSel+"%</option>");$obF.append('<option value="'+remArr2[0]+'">'+remArr2[0]+"%</option>")}if(chng!="fincC"&&$("#Finc_"+ebox+" .eSelfFincRemn").hasClass("sel")){fince.remS=number_only($("#Finc_"+ebox+" .ePutFincRemn").val())}else{fince.remS=$obF.val()}if(fince.remS>100){fince.rem=parseInt(fince.remS)}else if(setFinc.remb.indexOf("P")>=0){fince.rem=number_round(basCap*fince.remS/100,1e4,"floor")}else if(setFinc.remb.indexOf("C")>=0){fince.rem=number_round(fince.cap*fince.remS/100,1e4,"floor")}if(setFinc.remb.indexOf("P")>=0){fince.remR=number_round(fince.rem/basCap*1e3,1,"floor")/10}else if(setFinc.remb.indexOf("C")>=0){fince.remR=number_round(fince.rem/fince.cap*1e3,1,"floor")/10}}fince.lost=0;fince.lostRegi=0;fince.baseDC=0;fince.fincDC=0;if(chng=="compC"&&valCode.modl==0){if(setFinc.lmtb)fince.termCut=true;else fince.termCut=false}else if(setFinc.lmtb){var lmtArr=setFinc.lmtb.split("|");for(key in lmtArr){if(lmtArr[key]){var tmpArr=lmtArr[key].split(":");if(tmpArr[2].indexOf("M"+valCode.modl)>=0||tmpArr[2].indexOf("L"+valCode.line)>=0||tmpArr[2].indexOf("T"+valCode.trms)>=0){if(tmpArr[1].substr(0,1)=="-"){fince.lost=tmpArr[1]}else{if(tmpArr[0]=="0"){fince.baseDC=0}else if(tmpArr[0]<100){fince.baseDC=(price.base+price.itms+price.free)*tmpArr[0]/100;if(tmpArr.length>3){if(tmpArr[3].indexOf("V")>=0)fince.baseDC=fince.baseDC/1.1}if(valCode.brnd==312||valCode.brnd==316||valCode.brnd==326||valCode.brnd>340){fince.baseDC=number_round(fince.baseDC,1e4,"floor")}else if(valCode.brnd==307){fince.baseDC=number_round(fince.baseDC,100,"floor")}else{fince.baseDC=number_round(fince.baseDC,1,"round")}}else if(tmpArr[0].indexOf("+")>-1){var tmpArray=tmpArr[0].split("+");var vol=0;$.each(tmpArray,(function(i,v){v=number_only(v);if(Math.abs(v)>100){vol+=v}else{vol+=(price.base+price.itms)*(v*.01)}}));fince.baseDC=vol}else{fince.baseDC=parseInt(tmpArr[0])}if(tmpArr[1]=="0"){fince.fincDC=0}else if(tmpArr[1]<100){fince.fincDC=(price.base+price.itms+price.free)*tmpArr[1]/100;if(tmpArr.length>3){if(tmpArr[3].indexOf("V")>=0)fince.fincDC=fince.fincDC/1.1}fince.fincDC=number_round(fince.fincDC,100,"floor")}else if(tmpArr[1].indexOf("+")>-1){var tmpArray=tmpArr[1].split("+");var vol=0;$.each(tmpArray,(function(i,v){v=number_only(v);if(Math.abs(v)>100){vol+=v}else{vol+=(price.base+price.itms)*(v*.01)}}));fince.fincDC=vol}else{fince.fincDC=parseInt(tmpArr[1])}fince.lost=fince.baseDC-fince.fincDC;if(chng=="compC"){if(fince.lost)fince.termCut=true;else fince.termCut=false}else{fince.lostRegi=(entry.atax+entry.bondS)/price.entry*fince.lost/1.1;fince.lostRegi=number_round(fince.lostRegi,1,"round")}}}}}}fince.back=0;if(setFinc.csba&&setFinc.csba!="0"){var scba=setFinc.csba.split("|");if(scba.length==1){if(scba<100){fince.back=fince.cap*parseFloat(scba)/100;fince.backR=scba}else{fince.back=parseInt(scba);fince.backR=""}}else{var scbaArr=new Array;var scbaPercent=0;for(var a=0;a<scba.length;a++){scbaArr=scba[a].split(":");if(scbaArr[0]<100){if(scbaArr[0]<=fince.mon){scbaPercent=scbaArr[1]}}else{if(scbaArr[0]<=fince.cap){scbaPercent=scbaArr[1]}}}if(scbaPercent<100){fince.back=fince.cap*parseFloat(scbaPercent)/100;fince.backR=scbaPercent}else{fince.back=parseInt(scbaPercent);fince.backR=""}}}if(chng=="compC"){fince.cashback=0}else{if(fince.cas<0)calculate_cashback(0,"finc");else calculate_cashback(fince.cas,"finc")}fince.backC=0;fince.backCR=0;if(setFinc.csbc&&setFinc.csbc!=""){var csbcDataArray=new Array;var targetMinPrice=targetMaxPrice=0;var scbcArray=setFinc.csbc.split("|");var carPrice=number_only($(".eRsltPriceSum").html());for(i in scbcArray){csbcDataArray=scbcArray[i].split(":");targetMinPrice=csbcDataArray[0];targetMaxPrice=csbcDataArray[1];if(carPrice>=targetMinPrice&&carPrice<=targetMaxPrice){fince.backCR=csbcDataArray[2];fince.backC=carPrice*fince.backCR/100;break}}}if(chng=="compC"){fince.modl=setFinc.modl}finance_calculate();if(fince.preP){fince.cost=fince.itrSum-fince.back-fince.cashback-fince.preP+fince.lost+fince.lostRegi}else{fince.cost=fince.itrSum-fince.back-fince.cashback+fince.lost+fince.lostRegi}}function finance_calculate(){if(fince.kindC.substr(0,1)=="S"){fince.payM=number_round(finance_payment(fince.mon,fince.itr,fince.cap,0),1,"floor");fince.payEv=fince.payM;if(fince.itr==0)fince.itrSum=0;else fince.itrSum=fince.payM*fince.mon-fince.cap;fince.kindF="원리금 균등상환";if(typeof fince.nameF=="undefined")fince.nameF=fince.kindF;if(fince.kindC.substr(1,1)=="P"){var scbb=setFinc.csbb.split("|");if(scbb.length==1){if(scbb<100){fince.preP=fince.cas*parseFloat(scbb)/100;fince.preR=scbb}else{fince.preP=parseInt(scbb);fince.preR=""}}else{var scbbArr=new Array;var scbbPercent=0;for(var a=0;a<scbb.length;a++){scbbArr=scbb[a].split(":");if(scbbArr[0]<100){if(scbbArr[0]<=fince.mon){scbbPercent=scbbArr[1]}}else{if(scbbArr[0]<=fince.cas){scbbPercent=scbbArr[1]}}}if(scbbPercent<100){fince.preP=fince.cas*parseFloat(scbbPercent)/100;fince.preR=scbbPercent}else{fince.preP=parseInt(scbbPercent);fince.preR=""}}fince.schd="S:"+fince.mon+":"+fince.cap+":"+fince.itr+":"+fince.payM+":"+fince.nameF}else{fince.schd="S:"+fince.mon+":"+fince.cap+":"+fince.itr+":"+fince.payM+":"+fince.nameF}}else if(fince.kindC.substr(0,1)=="W"){var capMon=number_round(fince.cap/fince.mon,10,"round");var irtMon=fince.itr/12/100;var sttMon=capMon+number_round(fince.cap*irtMon,10,"round");var endMon=capMon+number_round(capMon*irtMon,10,"round");fince.payM=sttMon+"~"+endMon;fince.payEv=number_round((sttMon+endMon)/2,10,"round");fince.itrSum=fince.payEv*fince.mon-fince.cap;fince.kindF="원금 균등상환";if(typeof fince.nameF=="undefined")fince.nameF=fince.kindF;fince.schd="W:"+fince.mon+":"+fince.cap+":"+fince.itr+":"+sttMon+":"+fince.nameF}else if(fince.kindC.substr(0,1)=="U"){fince.payM=number_round(finance_payment(fince.mon,fince.itr,fince.cap,fince.rem),1,"floor");fince.payEv=fince.payM;var payU=number_round(fince.rem*fince.itr/12/100,1,"round");fince.itrSum=fince.payM*fince.mon-fince.cap+fince.rem;fince.kindF="원금일부 만기상환";if(typeof fince.nameF=="undefined")fince.nameF=fince.kindF;fince.schd="U:"+fince.mon+":"+fince.cap+"/"+fince.rem+":"+fince.itr+":"+fince.payM+":"+fince.nameF}else if(fince.kindC.substr(0,1)=="G"){fince.monG=parseInt(setFinc.monb);var sttMon=number_round(finance_payment(fince.monG,fince.itr,fince.cap,fince.cap),1,"floor");var endMon=number_round(finance_payment(fince.mon-fince.monG,fince.itr,fince.cap,0),1,"floor");fince.payM=sttMon+"~"+endMon;var payAll=sttMon*fince.monG+endMon*(fince.mon-fince.monG);fince.payEv=number_round(payAll/fince.mon,1,"round");fince.itrSum=payAll-fince.cap;fince.kindF="거치후 원리금상환";if(typeof fince.nameF=="undefined")fince.nameF=fince.kindF;fince.schd="G:"+fince.mon+":"+fince.cap+":"+fince.itr+":"+sttMon+"/"+endMon+"/"+fince.monG+":"+fince.nameF}else if(fince.kindC.substr(0,1)=="F"){fince.payM=number_round(finance_payment(fince.mon,fince.itr,fince.cap,fince.cap),1,"floor");fince.payEv=fince.payM;fince.itrSum=fince.payM*fince.mon;fince.kindF="원금 자유상환";if(typeof fince.nameF=="undefined")fince.nameF=fince.kindF;fince.schd="F:"+fince.mon+":"+fince.cap+":"+fince.itr+":"+fince.payM+":"+fince.nameF}if(fince.itrSum<0)fince.itrSum=0}function finance_payment(tem,irt,cap,rem){irt=parseFloat(irt/12/100);irtTem=Math.pow(1+irt,tem);if(irt==0)return(cap-rem)/tem;else return(cap-rem/irtTem)*(irt*irtTem)/(irtTem-1)}function finance_remain(tem,irt,cap,pay){irt=parseFloat(irt/12/100);for(t=0;t<tem;t++){ija=number_round(irt*cap,1,"round");cap-=pay-ija}return cap}function finance_rates(payR,temR,capR,remR){var irtR=25;var maxR=50;var minR=0;var pay=0;var rot=20;var gap=20;for(t=0;t<rot;t++){pay=finance_payment(temR,irtR,capR,remR);if(payR-pay>gap){minR=irtR;irtR+=(maxR-minR)/2}else if(payR-pay<gap*-1){maxR=irtR;irtR-=(maxR-minR)/2}else t=rot}return number_round(irtR*100,1,"round")/100}function calculate_lease(chng){if($("#eDiv_"+ebox+" .eSelfLeasName").hasClass("sel"))fince.name=$("#eDiv_"+ebox+" .ePutLeasName").val();else fince.name=setFinc.name;fince.code=codes.finc;fince.kind=setFinc.codk;fince.desc=setFinc.desc;if(chng!="copy"&&(chng=="fincM"||!$("#eDiv_"+ebox+" .eSelLeasMons option").size())){if(fince.kind=="LU"){$("#eDiv_"+ebox+" .eSelLeasRegi").val("E");$("#eDiv_"+ebox+" .eSelLeasTax").val("T")}else{$("#eDiv_"+ebox+" .eSelLeasRegi").val("X");$("#eDiv_"+ebox+" .eSelLeasTax").val("X")}}if(fince.kind=="LU"){$("#eDiv_"+ebox+" .eSubjLeaeRemn").text("잔존가치")}else{$("#eDiv_"+ebox+" .eSubjLeaeRemn").text("유 예 금")}if(typeof setFinc.mona=="undefined"||setFinc.mona==""){if(fince.kind=="LU")setFinc.mona="12|24|36|42|44|48|60";else setFinc.mona="6~60"}var monArr=setFinc.mona.split("|");var monSel=0;var monMin=0;var monMax=0;if(chng!="fincC"){var $obF=$("#eDiv_"+ebox+" .eSelLeasMons");$obF.html("")}moS=6;for(mo=0;mo<monArr.length;mo++){var monArr2=monArr[mo].split("~");if(!monArr2[1])monArr2[1]=monArr2[0];monArr2[0]=parseInt(monArr2[0]);monArr2[1]=parseInt(monArr2[1]);for(mo2=monArr2[0];mo2<=monArr2[1];mo2++){if(mo2==codes.mon){monSel=codes.mon}else if(mo2<codes.mon){monMin=mo2}else if(!monMax){monMax=mo2}if(mo2%moS==0||mo2==monSel||mo2==monArr2[0]||mo2==monArr2[1])$obF.append('<option value="'+mo2+'"> '+mo2+" 개월</option>")}}if(monSel){fince.mon=monSel}else if(monMin){fince.mon=monMin}else if(monMax){fince.mon=monMax}$obF.val(fince.mon);if($("#eDiv_"+ebox+" .eSelfLeasMons").hasClass("sel")){fince.mon=codes.mon}monSelL=-1;for(mo=0;mo<monArr.length;mo++){var monArr2=monArr[mo].split("~");if(!monArr2[1])monArr2[1]=monArr2[0];if(monSelL<0&&fince.mon<=parseInt(monArr2[1]))monSelL=mo}if(monSelL>=0){fince.monL=monSelL}if(chng=="copy"){fince.irr=codes.irr;$("#eDiv_"+ebox+" .ePutLeasRate").val(codes.irr)}else if(chng=="fincM"||$("#eDiv_"+ebox+" .ePutLeasRate").val()==""){fince.irr=setFinc.itr}else{fince.irr=number_only($("#eDiv_"+ebox+" .ePutLeasRate").val())}if(chng=="copy"){fince.feeR=codes.fee}else if(chng=="fincM"||$("#eDiv_"+ebox+" .ePutLeasFee").val()==""){fince.feeR=setFinc.fee}else{fince.feeR=number_only($("#eDiv_"+ebox+" .ePutLeasFee").val())}fince.total=price.total;fince.cash=0;fince.adds="";if($("#eDiv_"+ebox+" .eSelLeasRegi").val()=="E"){fince.total+=entry.total;fince.adds+="E"}else{fince.cash+=entry.total}if(typeof setFinc.stepR=="undefined"||setFinc.stepR=="")setFinc.stepR="1|5|1";var Rstep=setFinc.stepR.split("|");if(typeof setFinc.confR=="undefined"||setFinc.confR==""){if(fince.kind=="LU")setFinc.confR="0|30|30";else setFinc.confR="30|0|0"}var Rconf=setFinc.confR.split("|");if(typeof setFinc.cas=="undefined"||setFinc.cas=="")setFinc.cas="0~80";var stepArr=setFinc.cas.split("|");var stepSel=0;var stepArr2=new Array;if(!stepArr[1]){stepArr2=stepArr[0].split("~")}else{stepArr2=stepArr[fince.monL].split("~")}var $obF=$("#eDiv_"+ebox+" .eSelLeasCash");if(codes.cas!=""&&codes.cas<100){var stepSel=parseFloat(codes.cas)}else if(codes.cas){$("#eDiv_"+ebox+" .ePutLeasCash").val(codes.cas)}else if(chng=="fincM"||!$("#eDiv_"+ebox+" .eSelLeasCash option").size()){var stepSel=parseFloat(Rconf[0])}else{var stepSel=parseFloat($obF.val())}tmpCfg=setFinc.casS.split(",");if(tmpCfg[0]=="P")tmpVol=price.total-price.trns;else if(tmpCfg[0]=="T")tmpVol=price.total;else tmpVol=fince.total;if($("#eDiv_"+ebox+" .eSelfLeasCash").hasClass("sel")){fince.cas=number_only($("#eDiv_"+ebox+" .ePutLeasCash").val());if(fince.cas<100){stepSel=fince.cas;$("#eDiv_"+ebox+" .contLeas .Cash .mody button").removeClass("sel");$("#eDiv_"+ebox+" .contLeas .Cash .mody button").text("수정");$("#eDiv_"+ebox+" .contLeas .Cash .auto").removeClass("dis");$("#eDiv_"+ebox+" .contLeas .Cash .self").addClass("dis")}else{stepSel=number_round(fince.cas/tmpVol*100,1,"round")}}$obF.html("");if(stepArr2[1]){var stepR=parseFloat(Rstep[0]);var stepS=parseInt(stepArr2[0]);var stepE=parseInt(stepArr2[1]);if(stepSel<stepArr2[0]||stepSel>stepArr2[1])stepSel=-1;for(st=stepS;st<=stepE;st+=stepR){$obF.append('<option value="'+st+'"> '+st+" %</option>");if(stepSel>st&&stepSel<st+stepR){$obF.append('<option value="'+stepSel+'"> '+stepSel+" %</option>")}}if(stepSel<0)stepSel=stepE;$obF.val(stepSel)}else{$obF.append('<option value="'+stepArr2[1]+'">'+stepArr2[1]+"%</option>")}if($("#eDiv_"+ebox+" .eSelfLeasCash").hasClass("sel")){fince.cas=number_only($("#eDiv_"+ebox+" .ePutLeasCash").val());fince.casR=number_round(fince.cas/tmpVol*100,1,"round")}else{fince.casR=$("#eDiv_"+ebox+" .eSelLeasCash").val();fince.cas=number_round(tmpVol*fince.casR/100,parseInt(tmpCfg[1]),tmpCfg[2])}fince.total-=fince.cas;fince.cash+=fince.cas;if(typeof setFinc.dep=="undefined"||setFinc.dep=="")setFinc.dep="0~50";var stepArr=setFinc.dep.split("|");var stepSel=0;var stepArr2=new Array;if(!stepArr[1]){stepArr2=stepArr[0].split("~")}else{stepArr2=stepArr[fince.monL].split("~")}var $obF=$("#eDiv_"+ebox+" .eSelLeasDepo");if(codes.dep!=""&&codes.dep<100){var stepSel=parseFloat(codes.dep)}else if(codes.dep){$("#eDiv_"+ebox+" .ePutLeasDepo").val(codes.dep)}else if(chng=="fincM"||!$("#eDiv_"+ebox+" .eSelLeasDepo option").size()){var stepSel=parseFloat(Rconf[1])}else{var stepSel=parseFloat($obF.val())}tmpCfg=setFinc.depS.split(",");if(tmpCfg[0]=="P")tmpVol=price.total-price.trns;else if(tmpCfg[0]=="T")tmpVol=price.total;else tmpVol=fince.total;if($("#eDiv_"+ebox+" .eSelfLeasDepo").hasClass("sel")){fince.dep=number_only($("#eDiv_"+ebox+" .ePutLeasDepo").val());if(fince.dep<100){stepSel=fince.dep;$("#eDiv_"+ebox+" .contLeas .Depo .mody button").removeClass("sel");$("#eDiv_"+ebox+" .contLeas .Depo .mody button").text("수정");$("#eDiv_"+ebox+" .contLeas .Depo .auto").removeClass("dis");$("#eDiv_"+ebox+" .contLeas .Depo .self").addClass("dis")}else{stepSel=number_round(fince.dep/tmpVol*100,1,"round")}}$obF.html("");if(stepArr2[1]){var stepR=parseInt(Rstep[1]);var stepS=parseInt(stepArr2[0]);var stepE=parseInt(stepArr2[1]);if(stepSel<stepArr2[0]||stepSel>stepArr2[1])stepSel=-1;for(st=stepS;st<=stepE;st+=stepR){$obF.append('<option value="'+st+'"> '+st+" %</option>");if(stepSel>st&&stepSel<st+stepR){$obF.append('<option value="'+stepSel+'"> '+stepSel+" %</option>")}}if(stepSel<0)stepSel=stepE;$obF.val(stepSel)}else{$obF.append('<option value="'+stepArr2[1]+'">'+stepArr2[1]+"%</option>")}if($("#eDiv_"+ebox+" .eSelfLeasDepo").hasClass("sel")){fince.dep=number_only($("#eDiv_"+ebox+" .ePutLeasDepo").val());fince.depR=number_round(fince.dep/tmpVol*100,1,"round")}else{fince.depR=$("#eDiv_"+ebox+" .eSelLeasDepo").val();fince.dep=number_round(tmpVol*fince.depR/100,parseInt(tmpCfg[1]),tmpCfg[2])}fince.cash+=fince.dep;if(typeof setFinc.rem=="undefined"||setFinc.rem=="")setFinc.rem="0~50";var stepArr=setFinc.rem.split("|");var stepSel=0;var stepArr2=new Array;if(!stepArr[1]){stepArr2=stepArr[0].split("~")}else{stepArr2=stepArr[fince.monL].split("~")}var $obF=$("#eDiv_"+ebox+" .eSelLeasRemn");if(codes.rem!=""&&codes.rem<100){var stepSel=parseFloat(codes.rem)}else if(codes.rem){$("#eDiv_"+ebox+" .ePutLeasRemn").val(codes.rem)}else if(chng=="fincM"||!$("#eDiv_"+ebox+" .eSelLeasRemn option").size()){var stepSel=parseFloat(Rconf[2])}else{var stepSel=parseFloat($obF.val())}tmpCfg=setFinc.remS.split(",");if(tmpCfg[0]=="P")tmpVol=price.total-price.trns;else if(tmpCfg[0]=="T")tmpVol=price.total;else tmpVol=fince.total;if($("#eDiv_"+ebox+" .eSelfLeasRemn").hasClass("sel")){fince.rem=number_only($("#eDiv_"+ebox+" .ePutLeasRemn").val());if(fince.rem<100){stepSel=fince.rem;$("#eDiv_"+ebox+" .contLeas .Remn .mody button").removeClass("sel");$("#eDiv_"+ebox+" .contLeas .Remn .mody button").text("수정");$("#eDiv_"+ebox+" .contLeas .Remn .auto").removeClass("dis");$("#eDiv_"+ebox+" .contLeas .Remn .self").addClass("dis")}else{stepSel=number_round(fince.rem/tmpVol*100,1,"round")}}$obF.html("");if(stepArr2[1]){var stepR=parseFloat(Rstep[2]);var stepS=parseInt(stepArr2[0]);var stepE=parseInt(stepArr2[1]);if(stepSel<stepArr2[0]||stepSel>stepArr2[1]){stepSel=-1}for(st=stepS;st<=stepE;st+=stepR){$obF.append('<option value="'+st+'"> '+st+" %</option>");if(stepSel>st&&stepSel<st+stepR){$obF.append('<option value="'+stepSel+'"> '+stepSel+" %</option>")}}if(stepSel<0)stepSel=stepE;$obF.val(stepSel)}else{$obF.append('<option value="'+stepArr2[1]+'">'+stepArr2[1]+"%</option>")}if($("#eDiv_"+ebox+" .eSelfLeasRemn").hasClass("sel")){fince.rem=number_only($("#eDiv_"+ebox+" .ePutLeasRemn").val());fince.remR=number_round(fince.rem/tmpVol*1e3,1,"round")/10}else{fince.remR=$("#eDiv_"+ebox+" .eSelLeasRemn").val();fince.rem=number_round(tmpVol*fince.remR/100,parseInt(tmpCfg[1]),tmpCfg[2])}fince.fee=number_round(fince.feeR*fince.total/100,100,"floor");fince.payL=finance_payment(fince.mon,fince.irr,fince.total-fince.dep+fince.fee,fince.rem-fince.dep);tmpCfg=setFinc.payS.split(",");fince.payL=number_round(fince.payL,parseInt(tmpCfg[0]),tmpCfg[1]);tmpCfg=setFinc.taxS.split(",");fince.payT=number_round(infos.ytax/12,parseInt(tmpCfg[0]),tmpCfg[1]);if($("#eDiv_"+ebox+" .eSelLeasTax").val()=="T"){fince.adds+="T";fince.payM=fince.payL+fince.payT}else{fince.payM=fince.payL}fince.itr=finance_rates(fince.payL,fince.mon,fince.total,fince.rem);fince.itrSum=fince.payM*fince.mon-(fince.total-fince.rem)}function calculate_rentself(chng){fince.name=$("#eDiv_"+ebox+" .ePutRentName").val();fince.mon=number_only($("#eDiv_"+ebox+" .ePutRentMons").val());fince.cas=number_only($("#eDiv_"+ebox+" .ePutRentCash").val());fince.dep=number_only($("#eDiv_"+ebox+" .ePutRentDepo").val());fince.depR=number_only($("#eDiv_"+ebox+" .ePutRentDepoR").val());fince.rem=number_only($("#eDiv_"+ebox+" .ePutRentRemn").val());fince.rend=$("#eDiv_"+ebox+" .eSelRentEnds").val();fince.care=$("#eDiv_"+ebox+" .eSelRentCare").val();fince.payM=number_only($("#eDiv_"+ebox+" .ePutRentPayM").val());fince.cash=0;if(fince.dep)fince.cash+=fince.dep;if(fince.cas)fince.cash+=fince.cas}function schedule(eNo){schd=$("#eDiv_"+eNo+" .btnFincSchd").attr("schd");schdData=dnw_deChar(schd).split(":");if(schdData[0].substr(1))addKind=schdData[0].substr(1);else addKind="";schdData[0]=schdData[0].substr(0,1);schdData[1]=parseInt(schdData[1]);strL="";strR="";strH="";strL+="\t\t\t<table "+css.Table_LOPO+' style="width:100%;">';strR+="\t\t\t<table "+css.Table_LOPO+' style="width:100%;">';if(schdData[1]>24)addBr="<br />";else addBr="";if(addKind=="P"){strH+="\t\t\t<tr>";strH+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_gray+" "+css.Font_base+' width: 12%; " align="center"><b>회차</b></td>';strH+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_gray+" "+css.Font_base+' width: 17%; " align="center"><b>원금</b></td>';strH+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_gray+" "+css.Font_base+' width: 17%; " align="center"><b>이자</b></td>';strH+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_gray+" "+css.Font_base+' width: 17%; " align="center"><b>선납'+addBr+"할인</b></td>";strH+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_gray+" "+css.Font_base+' width: 17%; " align="center"><b>납부'+addBr+"금액</b></td>";strH+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_gray+" "+css.Font_base+' width: 20%; " align="center"><b>원금'+addBr+"잔액</b></td>";strH+="\t\t\t</tr>"}else{strH+="\t\t\t<tr>";strH+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_gray+" "+css.Font_base+' width: 15%; " align="center"><b>회차</b></td>';strH+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_gray+" "+css.Font_base+' width: 20%; " align="center"><b>원금</b></td>';strH+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_gray+" "+css.Font_base+' width: 20%; " align="center"><b>이자</b></td>';strH+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_gray+" "+css.Font_base+' width: 20%; " align="center"><b>납부'+addBr+"금액</b></td>";strH+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_gray+" "+css.Font_base+' width: 25%; " align="center"><b>원금'+addBr+"잔액</b></td>";strH+="\t\t\t</tr>"}if(schdData[0]=="S"||schdData[0]=="W"){rem=parseInt(schdData[2]);if(addKind=="P"){tmpPay=schdData[4].split("/");payM=parseInt(tmpPay[0]);payPre=parseInt(tmpPay[1]);preDcM=fince.mon-number_round(fince.preP/fince.payM,1,"ceil")+1}else if(schdData[0]=="S"){payM=parseInt(schdData[4])}else{capM=number_round(fince.cap/fince.mon,10,"round")}itr=schdData[3]}else if(schdData[0]=="U"){tmpRem=schdData[2].split("/");payM=parseInt(schdData[4]);rem=parseInt(tmpRem[0]);remU=parseInt(tmpRem[1]);itr=schdData[3]}else if(schdData[0]=="G"){rem=parseInt(schdData[2]);tmpPay=schdData[4].split("/");payG=parseInt(tmpPay[0]);payA=parseInt(tmpPay[1]);monG=parseInt(tmpPay[2]);itr=schdData[3]}else if(schdData[0]=="F"){rem=parseInt(schdData[2]);payM=parseInt(schdData[4]);itr=schdData[3]}strHead=schdData[5]+" (기간 "+schdData[1]+"회, 원금 "+number_format(rem)+"원, 금리 "+schdData[3]+"%)";strL+=strH;if(schdData[1]>24){strR+=strH}acc=0;capS=0;itrS=0;payS=0;str="";str+="\t\t\t<tr>";str+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_gray+" "+css.Font_base+' " align="center">-</td>';str+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="center">-</td>';str+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="center">-</td>';if(addKind=="P")str+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(payPre)+"</td>";str+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="center">-</td>';str+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_gray+" "+css.Font_base+' " align="right">'+number_format(rem)+"</td>";str+="\t\t\t</tr>";for(m=1;m<=schdData[1];m++){str+="\t\t\t<tr>";str+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_gray+" "+css.Font_base+' " align="center">'+m+"</td>";if(schdData[0]=="S"){itrM=number_round(rem*itr/12/100,1,"round");capM=payM-itrM;if(m==schdData[1]){capM=rem;if(itrM==0)payM=capM;else itrM=payM-capM}str+='\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(capM)+"</td>";str+='\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(itrM)+"</td>";if(addKind=="P"){payMpre=0;if(preDcM==m){payMpre=payPre-(schdData[1]-preDcM)*payM}else if(preDcM<m){payMpre=payM}str+='\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(payMpre)+"</td>";str+='\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(payM-payMpre)+"</td>"}else{str+='\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(payM)+"</td>"}}else if(schdData[0]=="W"){itrM=number_round(rem*itr/12/100,1,"round");payM=capM+itrM;if(m==schdData[1]){capM=rem;payM=capM+itrM}str+='\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(capM)+"</td>";str+='\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(itrM)+"</td>";str+='\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(payM)+"</td>"}else if(schdData[0]=="U"){itrM=number_round(rem*itr/12/100,1,"round");capM=payM-itrM;if(m==schdData[1]){capM=rem-remU;itrM=payM-capM}str+='\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(capM)+"</td>";str+='\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(itrM)+"</td>";str+='\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(payM)+"</td>"}else if(schdData[0]=="G"){if(m<=monG){itrM=payG;capM=0;payM=itrM}else{itrM=number_round(rem*itr/12/100,1,"round");capM=payA-itrM;payM=itrM+capM}if(m==schdData[1]){capM=rem;itrM=payA-capM;payM=itrM+capM}str+='\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(capM)+"</td>";str+='\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(itrM)+"</td>";str+='\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(payM)+"</td>"}else if(schdData[0]=="F"){itrM=payM;capM=0;str+='\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(capM)+"</td>";str+='\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(itrM)+"</td>";str+='\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_white+" "+css.Font_base+' " align="right">'+number_format(payM)+"</td>"}rem-=capM;acc+=payM;capS+=capM;itrS+=itrM;payS+=payM;str+='\t\t\t\t<td style="'+css.Td_LOPO+" "+css.Bg_gray+" "+css.Font_base+' " align="right">'+number_format(rem)+"</td>";str+="\t\t\t</tr>";if(schdData[1]>24&&number_round(schdData[1]/2,1,"floor")==m){strL+=str;str=""}}strFoot="총 납입액 "+number_format(acc)+"원 (원금상환 "+number_format(capS)+"원 + 이자합계 "+number_format(itrS)+"원)";if(schdData[1]<=24){strL+=str}else{strR+=str}strL+="\t\t\t</table>";strR+="\t\t\t</table>";str="";if(schdData[1]<=24){str+="\t<table "+css.Table_LXPX+' style="width:100%;">';str+='\t\t<tr><td style="'+css.Td_LXPX+" "+css.Bg_white+" "+css.Font_large+' " align="left">● '+strHead+"</td></tr>";str+="\t\t<tr>";str+='\t\t\t<td style="'+css.Td_LXPX+" "+css.Bg_white+" "+css.Font_base+' " align="left">'+strL+"</td>";str+="\t\t</tr>";str+='\t\t<tr><td style="'+css.Td_LXPX+" "+css.Bg_white+" "+css.Font_large+' " align="left">※ '+strFoot+"</td></tr>";str+="\t</table>"}else{str+="\t<table "+css.Table_LXPX+' style="width:100%;">';str+='\t\t<tr><td style="'+css.Td_LXPX+" "+css.Bg_white+" "+css.Font_large+' " align="left" colspan="3">● '+strHead+"</td></tr>";str+="\t\t<tr>";str+='\t\t\t<td style="'+css.Td_LXPX+" "+css.Bg_white+" "+css.Font_base+' " align="left" width="49%" valign="top">'+strL+"</td>";str+='\t\t\t<td style="'+css.Td_LXPX+" "+css.Bg_white+" "+css.Font_base+' " align="left" width="2%">&nbsp;</td>';str+='\t\t\t<td style="'+css.Td_LXPX+" "+css.Bg_white+" "+css.Font_base+' " align="left" width="49%" valign="top">'+strR+"</td>";str+="\t\t</tr>";str+='\t\t<tr><td style="'+css.Td_LXPX+" "+css.Bg_white+" "+css.Font_large+' " align="left" colspan="3">※ '+strFoot+"</td></tr>";str+="\t</table>"}return str}function scheduleSimple(fBox){var str="";schd=$("#fBox_"+fBox+"_rateSum").attr("schd");schdData=dnw_deChar(schd).split(":");if(schdData[0].substr(1))addKind=schdData[0].substr(1);else addKind="";schdData[0]=schdData[0].substr(0,1);schdData[1]=parseInt(schdData[1]);str+="<h4>"+schdData[5]+"</h4><table class='tableBlock' cellspacing='0'>";str+="\t\t\t<thead><tr>";str+="\t\t\t\t<th>월</td>";str+="\t\t\t\t<th>원금상환</td>";str+="\t\t\t\t<th>이자</td>";str+="\t\t\t\t<th>원금잔액</td>";str+="\t\t\t</tr></thead><tbody>";if(schdData[0]=="S"||schdData[0]=="W"){rem=parseInt(schdData[2]);if(addKind=="P"){tmpPay=schdData[4].split("/");payM=parseInt(tmpPay[0]);payPre=parseInt(tmpPay[1]);preDcM=fince.mon-number_round(fince.preP/fince.payM,1,"ceil")+1}else if(schdData[0]=="S"){payM=parseInt(schdData[4])}else{capM=number_round(fince.cap/fince.mon,10,"round")}itr=schdData[3]}else if(schdData[0]=="U"){tmpRem=schdData[2].split("/");payM=parseInt(schdData[4]);rem=parseInt(tmpRem[0]);remU=parseInt(tmpRem[1]);itr=schdData[3]}else if(schdData[0]=="G"){rem=parseInt(schdData[2]);tmpPay=schdData[4].split("/");payG=parseInt(tmpPay[0]);payA=parseInt(tmpPay[1]);monG=parseInt(tmpPay[2]);itr=schdData[3]}else if(schdData[0]=="F"){rem=parseInt(schdData[2]);payM=parseInt(schdData[4]);itr=schdData[3]}strHead=schdData[5]+" (기간 "+schdData[1]+"회, 원금 "+number_format(rem)+"원, 금리 "+schdData[3]+"%)";acc=0;capS=0;itrS=0;payS=0;str+="\t\t\t<tr>";str+="\t\t\t\t<td class='tdTitle' colspan='4'>"+number_format(rem)+"</td>";str+="\t\t\t</tr>";for(m=1;m<=schdData[1];m++){if(m%6==0)str+="\t\t\t<tr class='sixth'>";else str+="\t\t\t<tr>";str+="\t\t\t\t<td class='tdFirst tdTitle'>"+m+"</td>";if(schdData[0]=="S"){itrM=number_round(rem*itr/12/100,1,"round");capM=payM-itrM;if(m==schdData[1]){capM=rem;if(itrM==0)payM=capM;else itrM=payM-capM}str+="\t\t\t<td>"+number_format(capM)+"</td>";str+="\t\t\t<td>"+number_format(itrM)+"</td>"}else if(schdData[0]=="W"){itrM=number_round(rem*itr/12/100,1,"round");payM=capM+itrM;if(m==schdData[1]){capM=rem;payM=capM+itrM}str+="\t\t\t<td>"+number_format(capM)+"</td>";str+="\t\t\t<td>"+number_format(itrM)+"</td>"}else if(schdData[0]=="U"){itrM=number_round(rem*itr/12/100,1,"round");capM=payM-itrM;if(m==schdData[1]){capM=rem-remU;if(itrM==0)itrM=capM;else itrM=payM-capM}str+="\t\t\t<td>"+number_format(capM)+"</td>";str+="\t\t\t<td>"+number_format(itrM)+"</td>"}else if(schdData[0]=="G"){if(m<=monG){itrM=payG;capM=0;payM=itrM}else{itrM=number_round(rem*itr/12/100,1,"round");capM=payA-itrM;payM=itrM+capM}if(m==schdData[1]){capM=rem;itrM=payA-capM;payM=itrM+capM}str+="\t\t\t<td>"+number_format(capM)+"</td>";str+="\t\t\t<td>"+number_format(itrM)+"</td>"}else if(schdData[0]=="F"){itrM=payM;capM=0;str+="\t\t\t<td>"+number_format(capM)+"</td>";str+="\t\t\t<td>"+number_format(itrM)+"</td>"}rem-=capM;acc+=payM;capS+=capM;itrS+=itrM;payS+=payM;str+="\t\t\t\t<td>"+number_format(rem)+"</td>";str+="\t\t\t</tr>"}str+="\t\t\t</tbody></table>";str+="<div class='scheSum'>이자 합계 <span class='num'>"+number_format(itrS)+"</span></div>";$("#fBox_"+fBox+"_schedule").html(str)}var caculator_compare_on=false;function caculator_reset(codes){if(valCode.brnd){var wonNum=new Array("①","②","③","④","⑤","⑥","⑦","⑧","⑨","⑩","⑪","⑫","⑬","⑭","⑮");if(typeof estmDataTerm["B"+valCode.brnd]!="undefined"&&estmDataTerm["B"+valCode.brnd]!="none"&&typeof estmDataTerm["M"+valCode.modl]!="undefined"&&estmDataTerm["M"+valCode.modl]!="none"){var txt="";str=dnw_deChar2(estmDataTerm["B"+valCode.brnd]);dnw_array2(str,"setTermB");var str=dnw_deChar2(estmDataTerm["M"+valCode.modl]);dnw_array2(str,"setTermM");var ctB=0;var termBase=0;for(key in setTermM){if(setTermB[key]&&(key.substring(0,1)=="B"||key.substring(0,1)=="E")){var nam=setTermB[key].split("`");if(nam[7]=="1"||nam[7]=="2"){var tmp=setTermM[key].split("\n");if(nam[6]!="0")addBtn='<button type="button" class="helpView buttonHelp" no="'+nam[6]+'" kind="termInfo" subject="판매조건"><span class="screen_behind">보기</span></button>';else addBtn="";txt+="<dl><dt>"+nam[5]+addBtn+"</dt><dd>";ctB=0;ctNumOn=tmp.length;if(setTermM[key].indexOf("C`")>0)ctNumOn--;for(key2 in tmp){var tmp2=string_trim(tmp[key2]).split("`");if(tmp2[0]=="X"||tmp2[0]=="C"){txt+="<span class='cmnt'>※"+tmp2[1]+"</span>"}else if(tmp2[0].substring(0,1)=="F"){txt+='<span class="pric">';if(ctNumOn>1){txt+=wonNum[ctB]+" "}tmp2[0]=tmp2[0].substring(1);if(tmp2[0]==0){txt+=tmp2[1]}else if(tmp2[0]>=100){txt+=number_format(tmp2[0]/1e4)+"만원 할인 + "+tmp2[1]}else{txt+=tmp2[0]+"% 할인 + "+tmp2[1]}txt+="</span>";ctB++}else if(tmp2[0]==0){txt+='<span class="pric">';if(ctNumOn>1){txt+=wonNum[ctB]+" "}txt+=tmp2[1];txt+="</span>";ctB++}else{txt+='<span class="pric">';if(ctNumOn>1){txt+=wonNum[ctB]+" "}if(tmp2[0]>=100){txt+=number_format(tmp2[0]/1e4)+"만원 할인";termBase+=parseInt(tmp2[0])}else{txt+=tmp2[0]+"% 할인";termBase+=parseInt(tmp2[0])}if(tmp2[1])txt+="<span class='cmnt'>("+tmp2[1]+")</span>";txt+="</span>";ctB++}}if(ctB>1)txt+="<span class='cmnt'>※ 위 항목 중 1개만 선택 가능</span>"}txt+="</dd></dl>"}}if(ctB)$("#modelTerm").html(txt);if(termBase)$("#modelTermBase").val(termBase)}}var financeOption="<option value='self'>직접입력</option>";if(typeof estmDataFinc["B100"]!="undefined"){var str=dnw_deChar2(estmDataFinc["B100"]);dnw_array2(str,"setFincB");tmp=setFincB.fincList.split("!");for(var key in tmp){var tmp2=tmp[key].split("@");if(tmp2[4]!="3"&&tmp2[2].substring(0,1)!="L"){var goNext=1;if(valCode.brnd){if(tmp2[3]=="A"){}else if(tmp2[3]=="K"&&valCode.brnd<340){}else if(tmp2[3]=="I"&&valCode.brnd>340){}else if(tmp2[3].substring(0,1)=="W"&&tmp2[3].indexOf(valCode.brnd)>0){}else if(tmp2[3].substring(0,1)=="X"){if(tmp2[3].indexOf(valCode.brnd)>0)goNext=0;else if(valCode.brnd>340&&tmp2[3].indexOf("I")>0)goNext=0;else if(valCode.brnd<340&&tmp2[3].indexOf("K")>0)goNext=0}else{goNext=0}}if(goNext){financeOption+='<option value="'+tmp2[0]+'">'+tmp2[1]+"</option>"}}}}var captiveBrand=new Array(303,304,307,312,321,326);var captiveBrandName=new Array("현대","제네시스","기아","쉐보레","르노코리아","KGM");var sameAddName=new Array(""," A"," B"," C"," D"," E"," F");if(valCode.brnd==316){valCode.brnd=312}else if(valCode.brnd==322){valCode.brnd=321}var lineFincList=",";if(valCode.brnd){var str=dnw_deChar2(estmDataAuto["M"+valCode.modl]);dnw_array2(str,"setModl");var tmpL=setModl.lineupList.split("`");for(key in tmpL){var tmpL2=tmpL[key].split(":");var codeL=tmpL2[0].substring(7);var str=dnw_deChar2(estmDataAuto["L"+codeL]);dnw_array2(str,"setLine");lineFincList+=setLine.finc+","}}for(var key in captiveBrand){if(!valCode.brnd||captiveBrand[key]==valCode.brnd){var str=dnw_deChar2(estmDataFinc["B"+captiveBrand[key]]);dnw_array2(str,"setFincB");tmp=setFincB.fincList.split("!");var ct=tmp.length;var sameCt=0;var oldName="";for(var key2 in tmp){var tmp2=tmp[key2].split("@");var addName="";if(valCode.brnd){var goNext=0;if(lineFincList.indexOf(tmp2[0])>=0){goNext=1}}else{var goNext=1}if(tmp2[4]!="3"&&goNext){if(valCode.brnd){sameCt=0}else if(key2==ct-1){if(sameCt){if(oldName==tmp2[1])sameCt++;else sameCt=0}}else{if(sameCt){if(oldName==tmp2[1])sameCt++;else sameCt=0}else{var key3=parseInt(key2)+1;var tmp3=tmp[key3].split("@");if(tmp2[1]==tmp3[1])sameCt++;else sameCt=0}}if(sameCt){if(sameCt>6)sameCt=6;addName=sameAddName[sameCt]}financeOption+='<option value="'+tmp2[0]+'">'+tmp2[1].replace(/공식할부/gi,captiveBrandName[key])+addName+"</option>";oldName=tmp2[1]}}}}var financeType={S:"원리금 균등상환",W:"원금 균등상환",U:"원금일부 만기상환",G:"거치후 원리금상환",F:"원금 자유상환"};var typeOption="";for(var key in financeType){typeOption+='<option value="'+key+'">'+financeType[key]+"</option>"}var codeSet=codes.split("@");for(i=0;i<cboxs;i++){var fBox=i+1;if(!mobile&&i+1==cboxs)financeOption+="<option value='none'>선택하지 않음</option>";$("#fBox_"+fBox+"_kind").html(financeOption);$("#fBox_"+fBox+"_type").html(typeOption);var codeVal=codeSet[i].split(":");$("#fBox_"+fBox+"_kind").val(codeVal[0]);$("#fBox_"+fBox+"_type").val(codeVal[1]);$("#fBox_"+fBox+"_month").val(codeVal[2]);$("#fBox_"+fBox+"_rate").val(codeVal[3]);$("#fBox_"+fBox+"_capital").val(number_format(codeVal[4]));if(codeVal[1]=="G")$("#fBox_"+fBox+"_monthG").val(codeVal[5]);else if(codeVal[1]=="U")$("#fBox_"+fBox+"_capitalU").val(number_format(codeVal[5]));else $("#fBox_"+fBox+"_capitalU").val(codeVal[5]);caculator_action(fBox)}if(cboxs>1)caculator_compare()}function caculator_action(fBox){ebox=fBox;codes=new Array;codes.finc=$("#fBox_"+fBox+"_kind").val();if(codes.finc!="self"&&codes.finc!="none"){str=dnw_deChar2(estmDataFinc["F"+codes.finc]);dnw_array2(str,"setFinc")}else{setFinc=new Array}codes.mon=$("#fBox_"+fBox+"_month").val();codes.monG=$("#fBox_"+fBox+"_monthG").val();codes.cap=number_only($("#fBox_"+fBox+"_capital").val())*1e4;codes.capU=number_only($("#fBox_"+fBox+"_capitalU").val())*1e4;codes.rate=$("#fBox_"+fBox+"_rate").val();if(codes.cap==0){codes.cap=1e7;codes.rate=5;codes.mon=36}fince=new Array;if(codes.finc!="none"){calculate_finance("compC");$("#fBox_"+fBox+"_type").val(fince.kindC.substr(0,1));$("#fBox_"+fBox+"_typeTxt").text(fince.kindF);var typeHelp="";if(fince.kindC.substr(0,1)=="S")typeHelp='<span class="dictionaryView buttonHelp" val="330"><span class=\'screen_behind\'>보기</span></span>';else if(fince.kindC.substr(0,1)=="W")typeHelp='<span class="dictionaryView buttonHelp" val="331"><span class=\'screen_behind\'>보기</span></span>';else if(fince.kindC.substr(0,1)=="U")typeHelp='<span class="dictionaryView buttonHelp" val="333"><span class=\'screen_behind\'>보기</span></span>';else if(fince.kindC.substr(0,1)=="G")typeHelp='<span class="dictionaryView buttonHelp" val="334"><span class=\'screen_behind\'>보기</span></span>';else if(fince.kindC.substr(0,1)=="F")typeHelp='<span class="dictionaryView buttonHelp" val="332"><span class=\'screen_behind\'>보기</span></span>';$("#fBox_"+fBox+"_typeHelp").html(typeHelp);$("#fBox_"+fBox+"_month").val(fince.mon);if(fince.kindC.substr(0,1)=="G"){$("#fBox_"+fBox+"_monthG").val(fince.monG);$("#fBox_"+fBox+"_monthTxtG").text(fince.monG);$("#fBox_"+fBox+"_monthG").parent().removeClass("off")}else{$("#fBox_"+fBox+"_monthG").parent().addClass("off")}$("#fBox_"+fBox+"_rate").val(fince.itr);$("#fBox_"+fBox+"_rateTxt").text(fince.itr);$("#fBox_"+fBox+"_capital").val(number_format(fince.cap/1e4));if(fince.kindC.substr(0,1)=="U"){$("#fBox_"+fBox+"_capitalU").val(number_format(fince.rem/1e4));$("#fBox_"+fBox+"_capitalU").parent().removeClass("off")}else{$("#fBox_"+fBox+"_capitalU").parent().addClass("off")}}$("#fBox_"+fBox+"_month").addClass("off");$("#fBox_"+fBox+"_monthSel").removeClass("off");$("#fBox_"+fBox+"_capital").removeClass("off");$("#fBox_"+fBox+"_typeHelp").removeClass("off");$("#fBox_"+fBox+"_rate").parent().removeClass("off");$("#fBox_"+fBox+"_capitalUnit").removeClass("off");if(codes.finc=="self"){$("#fBox_"+fBox+"_type").removeClass("off");$("#fBox_"+fBox+"_typeTxt").addClass("off");$("#fBox_"+fBox+"_monthG").removeClass("off");$("#fBox_"+fBox+"_monthTxtG").addClass("off");$("#fBox_"+fBox+"_rate").removeClass("off");$("#fBox_"+fBox+"_rateTxt").addClass("off")}else if(codes.finc=="none"){$("#fBox_"+fBox+"_type").addClass("off");$("#fBox_"+fBox+"_typeTxt").addClass("off");$("#fBox_"+fBox+"_monthG").addClass("off");$("#fBox_"+fBox+"_monthTxtG").addClass("off");$("#fBox_"+fBox+"_monthSel").addClass("off");$("#fBox_"+fBox+"_capital").addClass("off");$("#fBox_"+fBox+"_rate").addClass("off");$("#fBox_"+fBox+"_rateTxt").addClass("off");$("#fBox_"+fBox+"_typeHelp").addClass("off");$("#fBox_"+fBox+"_capitalU").parent().addClass("off");$("#fBox_"+fBox+"_monthG").parent().addClass("off");$("#fBox_"+fBox+"_rate").parent().addClass("off");$("#fBox_"+fBox+"_capitalUnit").addClass("off")}else{$("#fBox_"+fBox+"_type").addClass("off");$("#fBox_"+fBox+"_typeTxt").removeClass("off");$("#fBox_"+fBox+"_monthG").addClass("off");$("#fBox_"+fBox+"_monthTxtG").removeClass("off");$("#fBox_"+fBox+"_rate").addClass("off");$("#fBox_"+fBox+"_rateTxt").removeClass("off")}if(codes.finc!="none"){var payTxt="";if(fince.kindC.substr(0,1)=="W"){var payArr=fince.payM.split("~");payTxt+="<div><span class='mon'>1회</span> <span class='pay'>"+number_format(payArr[0])+"</span></div>";payTxt+="<div><span class='mon'>~ "+fince.mon+"회</span> <span class='pay'>"+number_format(payArr[1])+"</span></div>";payTxt+="<input type='hidden' value='"+fince.payEv+"' id='fBox_"+fBox+"_payM_gap'>"}else if(fince.kindC.substr(0,1)=="G"){var payArr=fince.payM.split("~");payTxt+="<div><span class='mon'>1~"+fince.monG+"회</span> <span class='pay'>"+number_format(payArr[0])+"</span></div>";payTxt+="<div><span class='mon'>"+(fince.monG+1)+"~"+fince.mon+"회</span> <span class='pay'>"+number_format(payArr[1])+"</span></div>";payTxt+="<input type='hidden' value='"+fince.payEv+"' id='fBox_"+fBox+"_payM_gap'>"}else{payTxt+="<div><span class='pay'>"+number_format(fince.payM)+"</span></div>";payTxt+="<input type='hidden' value='"+fince.payM+"' id='fBox_"+fBox+"_payM_gap'>"}payTxt+="<div class='gap' id='fBox_"+fBox+"_payM_gapBox'></div>";$("#fBox_"+fBox+"_payM").html(payTxt);$("#fBox_"+fBox+"_rateSum").html("<div>"+number_format(fince.itrSum)+"</div><input type='hidden' value='"+fince.itrSum+"' id='fBox_"+fBox+"_rateSum_gap'>");if(fince.back)$("#fBox_"+fBox+"_cashBack").html("<div>(-) "+number_format(fince.back)+"</div><input type='hidden' value='"+fince.back+"' id='fBox_"+fBox+"_cashBack_gap'>");else $("#fBox_"+fBox+"_cashBack").html("<div>"+number_format(fince.back)+"</div><input type='hidden' value='"+fince.back+"' id='fBox_"+fBox+"_cashBack_gap'>");$("#fBox_"+fBox+"_range").html(fince.modl);if(valCode.brnd&&valCode.brnd<340&&$("#modelTermBase").val()){var baseTerm=number_only($("#modelTermBase").val());if(baseTerm<100)baseTerm=baseTerm*price.base/100}else{var baseTerm=0}var lostTxt="";if(valCode.modl&&baseTerm){if(fince.lost&&baseTerm!=fince.baseDC){fince.lost=baseTerm-fince.fincDC}if(fince.lost&&baseTerm-fince.lost>0)lostTxt="<span class='lostX'>(-) "+number_format(baseTerm-fince.lost)+"</span><span class='lostO off num'><br />(-) "+number_format(fince.lost)+"</span>";else if(fince.lost)lostTxt="<span class='lostX'>"+number_format(baseTerm-fince.lost)+"</span><span class='lostO num off'><br />"+number_format(fince.lost)+"</span>";else lostTxt="<span class='lostX'>(-) "+number_format(baseTerm)+"</span><br /><span class='lostO off'>없음</span>"}else{if(fince.termCut)lostTxt="<span class='lostO'>기본할인 일부 적용되지 않음</span><br /><button type='button' class='btnOpenChoice' tab='model'>모델을 선택하여 확인하세요.</button>";else lostTxt="<span class='lostX'>기본할인 적용 가능</span>"}$("#fBox_"+fBox+"_termCut").html(lostTxt);var lostSum=fince.itrSum-fince.back+fince.lost-baseTerm;if(lostSum<0)$("#fBox_"+fBox+"_costSum").html("<div>(-) "+number_format(lostSum*-1)+"</div><input type='hidden' value='"+lostSum+"' id='fBox_"+fBox+"_costSum_gap'><div class='gap' id='fBox_"+fBox+"_costSum_gapBox'></div>");else $("#fBox_"+fBox+"_costSum").html("<div>"+number_format(lostSum)+"</div><input type='hidden' value='"+lostSum+"' id='fBox_"+fBox+"_costSum_gap'><div class='gap' id='fBox_"+fBox+"_costSum_gapBox'></div>");$("#fBox_"+fBox+"_rateSum").attr("schd",dnw_enChar(fince.schd));var linkUrl="";linkUrl+=codes.finc+":"+fince.kindC.substr(0,1)+":"+fince.mon+":"+fince.itr+":"+fince.cap/1e4+":";if(fince.kindC.substr(0,1)=="G")linkUrl+=fince.monG;else if(fince.kindC=="U")linkUrl+=fince.rem/1e4;$("#fBox_"+fBox+"_kind").attr("link",linkUrl);scheduleSimple(fBox)}else{$("#fBox_"+fBox+"_range").html("");$("#fBox_"+fBox+"_kind").attr("link","none");$("#fBox_"+fBox+"_payM").html("");$("#fBox_"+fBox+"_rateSum").html("");$("#fBox_"+fBox+"_cashBack").html("");$("#fBox_"+fBox+"_termCut").html("");$("#fBox_"+fBox+"_costSum").html("");$("#fBox_"+fBox+"_schedule").html("<h4>선택하지 않음</h4><table class='tableBlock' cellspacing='' style='width:214px;'></table>")}if(caculator_compare_on&&cboxs>1)caculator_compare()}function caculator_compare(){var gapList=new Array("payM","costSum");var base=new Array;var linkUrl="";for(i=1;i<=cboxs;i++){for(col in gapList){pVal=parseInt($("#fBox_"+i+"_"+gapList[col]+"_gap").val());if(i==1){base[col]=pVal;$("#fBox_"+i+"_"+gapList[col]+"_gapBox").addClass("off")}else{var gap=pVal-base[col];if(gap>0){gapTxt='<span class="up">▲ '+number_format(gap)+"</span>"}else if(gap<0){gap=gap*-1;gapTxt='<span class="down">▼ '+number_format(gap)+"</span>"}else{gapTxt='<span class="same">-</span>'}$("#fBox_"+i+"_"+gapList[col]+"_gapBox").removeClass("off");$("#fBox_"+i+"_"+gapList[col]+"_gapBox").html(gapTxt)}}if(linkUrl)linkUrl+="@";linkUrl+=$("#fBox_"+i+"_kind").attr("link")}if(model)linkUrl+="&Brand="+brand+"&Model="+model;$("meta[property='og:url']").attr("content","http://"+location.host+"/buy/?Work=calculator&Code="+linkUrl);caculator_compare_on=true}$((function(){$(document).on("change","[id $= '_kind'],[id $= '_type']",(function(){var fNo=$(this).attr("id").substring(5,6);caculator_action(fNo)}));$(document).on("change","[id $= '_monthSel']",(function(){var fNo=$(this).attr("id").substring(5,6);var mon=$(this).val();$("#fBox_"+fNo+"_month").val(mon);caculator_action(fNo)}));$(document).on("blur",".choice input[type = text]",(function(){var fNo=$(this).attr("id").substring(5,6);caculator_action(fNo)}));$(document).on("keydown",".choice input[type = text]",(function(e){if(e.which==13){var fNo=$(this).attr("id").substring(5,6);caculator_action(fNo)}}))}));